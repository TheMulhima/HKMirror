namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for CameraFade class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class OnCameraFade
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void HookAwake()
        {
            if (!HookedList.Contains("Awake"))
            {
                HookedList.Add("Awake");
                On.CameraFade.Awake += Awake;
            }
        }

        internal static event Delegates.Awake_BeforeArgs _beforeAwake;
        internal static event Delegates.Awake_NormalArgs _afterAwake;

        private static void Awake(On.CameraFade.orig_Awake orig, CameraFade self)
        {
            Delegates.Params_Awake @params = new()
            {
                self = self
            };
            _beforeAwake?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterAwake != null) _afterAwake.Invoke(@params);
        }

        internal static void HookStart()
        {
            if (!HookedList.Contains("Start"))
            {
                HookedList.Add("Start");
                On.CameraFade.Start += Start;
            }
        }

        internal static event Delegates.Start_BeforeArgs _beforeStart;

        private static IEnumerator Start(On.CameraFade.orig_Start orig, CameraFade self)
        {
            Delegates.Params_Start @params = new()
            {
                self = self
            };
            _beforeStart?.Invoke(@params);
            self = @params.self;
            return orig(self);
        }

        internal static void HookOnGUI()
        {
            if (!HookedList.Contains("OnGUI"))
            {
                HookedList.Add("OnGUI");
                On.CameraFade.OnGUI += OnGUI;
            }
        }

        internal static event Delegates.OnGUI_BeforeArgs _beforeOnGUI;
        internal static event Delegates.OnGUI_NormalArgs _afterOnGUI;

        private static void OnGUI(On.CameraFade.orig_OnGUI orig, CameraFade self)
        {
            Delegates.Params_OnGUI @params = new()
            {
                self = self
            };
            _beforeOnGUI?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnGUI != null) _afterOnGUI.Invoke(@params);
        }

        internal static void HookSetScreenOverlayColor()
        {
            if (!HookedList.Contains("SetScreenOverlayColor"))
            {
                HookedList.Add("SetScreenOverlayColor");
                On.CameraFade.SetScreenOverlayColor += SetScreenOverlayColor;
            }
        }

        internal static event Delegates.SetScreenOverlayColor_BeforeArgs _beforeSetScreenOverlayColor;
        internal static event Delegates.SetScreenOverlayColor_NormalArgs _afterSetScreenOverlayColor;

        private static void SetScreenOverlayColor(On.CameraFade.orig_SetScreenOverlayColor orig, CameraFade self,
            Color newScreenOverlayColor)
        {
            Delegates.Params_SetScreenOverlayColor @params = new()
            {
                self = self, newScreenOverlayColor = newScreenOverlayColor
            };
            _beforeSetScreenOverlayColor?.Invoke(@params);
            self = @params.self;
            newScreenOverlayColor = @params.newScreenOverlayColor;
            orig(self, newScreenOverlayColor);
            if (_afterSetScreenOverlayColor != null) _afterSetScreenOverlayColor.Invoke(@params);
        }

        internal static void HookStartFade()
        {
            if (!HookedList.Contains("StartFade"))
            {
                HookedList.Add("StartFade");
                On.CameraFade.StartFade += StartFade;
            }
        }

        internal static event Delegates.StartFade_BeforeArgs _beforeStartFade;
        internal static event Delegates.StartFade_NormalArgs _afterStartFade;

        private static void StartFade(On.CameraFade.orig_StartFade orig, CameraFade self, Color newScreenOverlayColor,
            float fadeDuration)
        {
            Delegates.Params_StartFade @params = new()
            {
                self = self, newScreenOverlayColor = newScreenOverlayColor, fadeDuration = fadeDuration
            };
            _beforeStartFade?.Invoke(@params);
            self = @params.self;
            newScreenOverlayColor = @params.newScreenOverlayColor;
            fadeDuration = @params.fadeDuration;
            orig(self, newScreenOverlayColor, fadeDuration);
            if (_afterStartFade != null) _afterStartFade.Invoke(@params);
        }

        internal static void HookFadeToBlack()
        {
            if (!HookedList.Contains("FadeToBlack"))
            {
                HookedList.Add("FadeToBlack");
                On.CameraFade.FadeToBlack += FadeToBlack;
            }
        }

        internal static event Delegates.FadeToBlack_BeforeArgs _beforeFadeToBlack;
        internal static event Delegates.FadeToBlack_NormalArgs _afterFadeToBlack;

        private static void FadeToBlack(On.CameraFade.orig_FadeToBlack orig, CameraFade self, float duration)
        {
            Delegates.Params_FadeToBlack @params = new()
            {
                self = self, duration = duration
            };
            _beforeFadeToBlack?.Invoke(@params);
            self = @params.self;
            duration = @params.duration;
            orig(self, duration);
            if (_afterFadeToBlack != null) _afterFadeToBlack.Invoke(@params);
        }

        internal static void HookFadeToTransparent()
        {
            if (!HookedList.Contains("FadeToTransparent"))
            {
                HookedList.Add("FadeToTransparent");
                On.CameraFade.FadeToTransparent += FadeToTransparent;
            }
        }

        internal static event Delegates.FadeToTransparent_BeforeArgs _beforeFadeToTransparent;
        internal static event Delegates.FadeToTransparent_NormalArgs _afterFadeToTransparent;

        private static void FadeToTransparent(On.CameraFade.orig_FadeToTransparent orig, CameraFade self,
            float duration)
        {
            Delegates.Params_FadeToTransparent @params = new()
            {
                self = self, duration = duration
            };
            _beforeFadeToTransparent?.Invoke(@params);
            self = @params.self;
            duration = @params.duration;
            orig(self, duration);
            if (_afterFadeToTransparent != null) _afterFadeToTransparent.Invoke(@params);
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void Awake_BeforeArgs(Params_Awake args);

        public delegate void Awake_NormalArgs(Params_Awake args);

        public delegate void FadeToBlack_BeforeArgs(Params_FadeToBlack args);

        public delegate void FadeToBlack_NormalArgs(Params_FadeToBlack args);

        public delegate void FadeToTransparent_BeforeArgs(Params_FadeToTransparent args);

        public delegate void FadeToTransparent_NormalArgs(Params_FadeToTransparent args);

        public delegate void OnGUI_BeforeArgs(Params_OnGUI args);

        public delegate void OnGUI_NormalArgs(Params_OnGUI args);

        public delegate void SetScreenOverlayColor_BeforeArgs(Params_SetScreenOverlayColor args);

        public delegate void SetScreenOverlayColor_NormalArgs(Params_SetScreenOverlayColor args);

        public delegate void Start_BeforeArgs(Params_Start args);

        public delegate IEnumerator Start_NormalArgs(Params_Start args);

        public delegate void StartFade_BeforeArgs(Params_StartFade args);

        public delegate void StartFade_NormalArgs(Params_StartFade args);

        public sealed class Params_Awake
        {
            public CameraFade self;
        }

        public sealed class Params_Start
        {
            public CameraFade self;
        }

        public sealed class Params_OnGUI
        {
            public CameraFade self;
        }

        public sealed class Params_SetScreenOverlayColor
        {
            public Color newScreenOverlayColor;
            public CameraFade self;
        }

        public sealed class Params_StartFade
        {
            public float fadeDuration;
            public Color newScreenOverlayColor;
            public CameraFade self;
        }

        public sealed class Params_FadeToBlack
        {
            public float duration;
            public CameraFade self;
        }

        public sealed class Params_FadeToTransparent
        {
            public float duration;
            public CameraFade self;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.Awake_BeforeArgs Awake
        {
            add
            {
                HookHandler._beforeAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._beforeAwake -= value;
        }

        public static event Delegates.Start_BeforeArgs Start
        {
            add
            {
                HookHandler._beforeStart += value;
                HookHandler.HookStart();
            }
            remove => HookHandler._beforeStart -= value;
        }

        public static event Delegates.OnGUI_BeforeArgs OnGUI
        {
            add
            {
                HookHandler._beforeOnGUI += value;
                HookHandler.HookOnGUI();
            }
            remove => HookHandler._beforeOnGUI -= value;
        }

        public static event Delegates.SetScreenOverlayColor_BeforeArgs SetScreenOverlayColor
        {
            add
            {
                HookHandler._beforeSetScreenOverlayColor += value;
                HookHandler.HookSetScreenOverlayColor();
            }
            remove => HookHandler._beforeSetScreenOverlayColor -= value;
        }

        public static event Delegates.StartFade_BeforeArgs StartFade
        {
            add
            {
                HookHandler._beforeStartFade += value;
                HookHandler.HookStartFade();
            }
            remove => HookHandler._beforeStartFade -= value;
        }

        public static event Delegates.FadeToBlack_BeforeArgs FadeToBlack
        {
            add
            {
                HookHandler._beforeFadeToBlack += value;
                HookHandler.HookFadeToBlack();
            }
            remove => HookHandler._beforeFadeToBlack -= value;
        }

        public static event Delegates.FadeToTransparent_BeforeArgs FadeToTransparent
        {
            add
            {
                HookHandler._beforeFadeToTransparent += value;
                HookHandler.HookFadeToTransparent();
            }
            remove => HookHandler._beforeFadeToTransparent -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.Awake_NormalArgs Awake
        {
            add
            {
                HookHandler._afterAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._afterAwake -= value;
        }

        public static event Delegates.OnGUI_NormalArgs OnGUI
        {
            add
            {
                HookHandler._afterOnGUI += value;
                HookHandler.HookOnGUI();
            }
            remove => HookHandler._afterOnGUI -= value;
        }

        public static event Delegates.SetScreenOverlayColor_NormalArgs SetScreenOverlayColor
        {
            add
            {
                HookHandler._afterSetScreenOverlayColor += value;
                HookHandler.HookSetScreenOverlayColor();
            }
            remove => HookHandler._afterSetScreenOverlayColor -= value;
        }

        public static event Delegates.StartFade_NormalArgs StartFade
        {
            add
            {
                HookHandler._afterStartFade += value;
                HookHandler.HookStartFade();
            }
            remove => HookHandler._afterStartFade -= value;
        }

        public static event Delegates.FadeToBlack_NormalArgs FadeToBlack
        {
            add
            {
                HookHandler._afterFadeToBlack += value;
                HookHandler.HookFadeToBlack();
            }
            remove => HookHandler._afterFadeToBlack -= value;
        }

        public static event Delegates.FadeToTransparent_NormalArgs FadeToTransparent
        {
            add
            {
                HookHandler._afterFadeToTransparent += value;
                HookHandler.HookFadeToTransparent();
            }
            remove => HookHandler._afterFadeToTransparent -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event On.CameraFade.hook_Awake Awake
        {
            add => On.CameraFade.Awake += value;
            remove => On.CameraFade.Awake -= value;
        }

        public static event On.CameraFade.hook_Start Start
        {
            add => On.CameraFade.Start += value;
            remove => On.CameraFade.Start -= value;
        }

        public static event On.CameraFade.hook_OnGUI OnGUI
        {
            add => On.CameraFade.OnGUI += value;
            remove => On.CameraFade.OnGUI -= value;
        }

        public static event On.CameraFade.hook_SetScreenOverlayColor SetScreenOverlayColor
        {
            add => On.CameraFade.SetScreenOverlayColor += value;
            remove => On.CameraFade.SetScreenOverlayColor -= value;
        }

        public static event On.CameraFade.hook_StartFade StartFade
        {
            add => On.CameraFade.StartFade += value;
            remove => On.CameraFade.StartFade -= value;
        }

        public static event On.CameraFade.hook_FadeToBlack FadeToBlack
        {
            add => On.CameraFade.FadeToBlack += value;
            remove => On.CameraFade.FadeToBlack -= value;
        }

        public static event On.CameraFade.hook_FadeToTransparent FadeToTransparent
        {
            add => On.CameraFade.FadeToTransparent += value;
            remove => On.CameraFade.FadeToTransparent -= value;
        }
    }
}