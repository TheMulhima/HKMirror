using MonoMod.RuntimeDetour;
using MonoMod.RuntimeDetour.HookGen;
using TMPro;

namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for InlineGraphic class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class OnInlineGraphic
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void Hookget_mainTexture()
        {
            if (!HookedList.Contains("get_mainTexture"))
            {
                HookedList.Add("get_mainTexture");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "get_mainTexture"), get_mainTexture);
            }
        }

        internal static event Delegates.get_mainTexture_BeforeArgs _beforeget_mainTexture;
        internal static event Delegates.get_mainTexture_NormalArgs _afterget_mainTexture;

        private static Texture get_mainTexture(Func<InlineGraphic, Texture> orig, InlineGraphic self)
        {
            Delegates.Params_get_mainTexture @params = new()
            {
                self = self
            };
            _beforeget_mainTexture?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_mainTexture != null) retVal = _afterget_mainTexture.Invoke(@params);
            return retVal;
        }

        internal static void HookAwake()
        {
            if (!HookedList.Contains("Awake"))
            {
                HookedList.Add("Awake");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "Awake"), Awake);
            }
        }

        internal static event Delegates.Awake_BeforeArgs _beforeAwake;
        internal static event Delegates.Awake_NormalArgs _afterAwake;

        private static void Awake(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_Awake @params = new()
            {
                self = self
            };
            _beforeAwake?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterAwake != null) _afterAwake.Invoke(@params);
        }

        internal static void HookOnEnable()
        {
            if (!HookedList.Contains("OnEnable"))
            {
                HookedList.Add("OnEnable");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnEnable"), OnEnable);
            }
        }

        internal static event Delegates.OnEnable_BeforeArgs _beforeOnEnable;
        internal static event Delegates.OnEnable_NormalArgs _afterOnEnable;

        private static void OnEnable(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_OnEnable @params = new()
            {
                self = self
            };
            _beforeOnEnable?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnEnable != null) _afterOnEnable.Invoke(@params);
        }

        internal static void HookOnDisable()
        {
            if (!HookedList.Contains("OnDisable"))
            {
                HookedList.Add("OnDisable");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnDisable"), OnDisable);
            }
        }

        internal static event Delegates.OnDisable_BeforeArgs _beforeOnDisable;
        internal static event Delegates.OnDisable_NormalArgs _afterOnDisable;

        private static void OnDisable(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_OnDisable @params = new()
            {
                self = self
            };
            _beforeOnDisable?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnDisable != null) _afterOnDisable.Invoke(@params);
        }

        internal static void HookOnTransformParentChanged()
        {
            if (!HookedList.Contains("OnTransformParentChanged"))
            {
                HookedList.Add("OnTransformParentChanged");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnTransformParentChanged"),
                    OnTransformParentChanged);
            }
        }

        internal static event Delegates.OnTransformParentChanged_BeforeArgs _beforeOnTransformParentChanged;
        internal static event Delegates.OnTransformParentChanged_NormalArgs _afterOnTransformParentChanged;

        private static void OnTransformParentChanged(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_OnTransformParentChanged @params = new()
            {
                self = self
            };
            _beforeOnTransformParentChanged?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnTransformParentChanged != null) _afterOnTransformParentChanged.Invoke(@params);
        }

        internal static void HookOnRectTransformDimensionsChange()
        {
            if (!HookedList.Contains("OnRectTransformDimensionsChange"))
            {
                HookedList.Add("OnRectTransformDimensionsChange");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnRectTransformDimensionsChange"),
                    OnRectTransformDimensionsChange);
            }
        }

        internal static event Delegates.OnRectTransformDimensionsChange_BeforeArgs
            _beforeOnRectTransformDimensionsChange;

        internal static event Delegates.OnRectTransformDimensionsChange_NormalArgs
            _afterOnRectTransformDimensionsChange;

        private static void OnRectTransformDimensionsChange(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_OnRectTransformDimensionsChange @params = new()
            {
                self = self
            };
            _beforeOnRectTransformDimensionsChange?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnRectTransformDimensionsChange != null) _afterOnRectTransformDimensionsChange.Invoke(@params);
        }

        internal static void HookUpdateMaterial()
        {
            if (!HookedList.Contains("UpdateMaterial"))
            {
                HookedList.Add("UpdateMaterial");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateMaterial"), UpdateMaterial);
            }
        }

        internal static event Delegates.UpdateMaterial_BeforeArgs _beforeUpdateMaterial;
        internal static event Delegates.UpdateMaterial_NormalArgs _afterUpdateMaterial;

        private static void UpdateMaterial(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_UpdateMaterial @params = new()
            {
                self = self
            };
            _beforeUpdateMaterial?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterUpdateMaterial != null) _afterUpdateMaterial.Invoke(@params);
        }

        internal static void HookUpdateGeometry()
        {
            if (!HookedList.Contains("UpdateGeometry"))
            {
                HookedList.Add("UpdateGeometry");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateGeometry"), UpdateGeometry);
            }
        }

        internal static event Delegates.UpdateGeometry_BeforeArgs _beforeUpdateGeometry;
        internal static event Delegates.UpdateGeometry_NormalArgs _afterUpdateGeometry;

        private static void UpdateGeometry(Action<InlineGraphic> orig, InlineGraphic self)
        {
            Delegates.Params_UpdateGeometry @params = new()
            {
                self = self
            };
            _beforeUpdateGeometry?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterUpdateGeometry != null) _afterUpdateGeometry.Invoke(@params);
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void Awake_BeforeArgs(Params_Awake args);

        public delegate void Awake_NormalArgs(Params_Awake args);

        public delegate void get_mainTexture_BeforeArgs(Params_get_mainTexture args);

        public delegate Texture get_mainTexture_NormalArgs(Params_get_mainTexture args);

        public delegate void OnDisable_BeforeArgs(Params_OnDisable args);

        public delegate void OnDisable_NormalArgs(Params_OnDisable args);

        public delegate void OnEnable_BeforeArgs(Params_OnEnable args);

        public delegate void OnEnable_NormalArgs(Params_OnEnable args);

        public delegate void OnRectTransformDimensionsChange_BeforeArgs(Params_OnRectTransformDimensionsChange args);

        public delegate void OnRectTransformDimensionsChange_NormalArgs(Params_OnRectTransformDimensionsChange args);

        public delegate void OnTransformParentChanged_BeforeArgs(Params_OnTransformParentChanged args);

        public delegate void OnTransformParentChanged_NormalArgs(Params_OnTransformParentChanged args);

        public delegate void UpdateGeometry_BeforeArgs(Params_UpdateGeometry args);

        public delegate void UpdateGeometry_NormalArgs(Params_UpdateGeometry args);

        public delegate void UpdateMaterial_BeforeArgs(Params_UpdateMaterial args);

        public delegate void UpdateMaterial_NormalArgs(Params_UpdateMaterial args);

        public sealed class Params_get_mainTexture
        {
            public InlineGraphic self;
        }

        public sealed class Params_Awake
        {
            public InlineGraphic self;
        }

        public sealed class Params_OnEnable
        {
            public InlineGraphic self;
        }

        public sealed class Params_OnDisable
        {
            public InlineGraphic self;
        }

        public sealed class Params_OnTransformParentChanged
        {
            public InlineGraphic self;
        }

        public sealed class Params_OnRectTransformDimensionsChange
        {
            public InlineGraphic self;
        }

        public sealed class Params_UpdateMaterial
        {
            public InlineGraphic self;
        }

        public sealed class Params_UpdateGeometry
        {
            public InlineGraphic self;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.get_mainTexture_BeforeArgs get_mainTexture
        {
            add
            {
                HookHandler._beforeget_mainTexture += value;
                HookHandler.Hookget_mainTexture();
            }
            remove => HookHandler._beforeget_mainTexture -= value;
        }

        public static event Delegates.Awake_BeforeArgs Awake
        {
            add
            {
                HookHandler._beforeAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._beforeAwake -= value;
        }

        public static event Delegates.OnEnable_BeforeArgs OnEnable
        {
            add
            {
                HookHandler._beforeOnEnable += value;
                HookHandler.HookOnEnable();
            }
            remove => HookHandler._beforeOnEnable -= value;
        }

        public static event Delegates.OnDisable_BeforeArgs OnDisable
        {
            add
            {
                HookHandler._beforeOnDisable += value;
                HookHandler.HookOnDisable();
            }
            remove => HookHandler._beforeOnDisable -= value;
        }

        public static event Delegates.OnTransformParentChanged_BeforeArgs OnTransformParentChanged
        {
            add
            {
                HookHandler._beforeOnTransformParentChanged += value;
                HookHandler.HookOnTransformParentChanged();
            }
            remove => HookHandler._beforeOnTransformParentChanged -= value;
        }

        public static event Delegates.OnRectTransformDimensionsChange_BeforeArgs OnRectTransformDimensionsChange
        {
            add
            {
                HookHandler._beforeOnRectTransformDimensionsChange += value;
                HookHandler.HookOnRectTransformDimensionsChange();
            }
            remove => HookHandler._beforeOnRectTransformDimensionsChange -= value;
        }

        public static event Delegates.UpdateMaterial_BeforeArgs UpdateMaterial
        {
            add
            {
                HookHandler._beforeUpdateMaterial += value;
                HookHandler.HookUpdateMaterial();
            }
            remove => HookHandler._beforeUpdateMaterial -= value;
        }

        public static event Delegates.UpdateGeometry_BeforeArgs UpdateGeometry
        {
            add
            {
                HookHandler._beforeUpdateGeometry += value;
                HookHandler.HookUpdateGeometry();
            }
            remove => HookHandler._beforeUpdateGeometry -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.get_mainTexture_NormalArgs get_mainTexture
        {
            add
            {
                HookHandler._afterget_mainTexture += value;
                HookHandler.Hookget_mainTexture();
            }
            remove => HookHandler._afterget_mainTexture -= value;
        }

        public static event Delegates.Awake_NormalArgs Awake
        {
            add
            {
                HookHandler._afterAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._afterAwake -= value;
        }

        public static event Delegates.OnEnable_NormalArgs OnEnable
        {
            add
            {
                HookHandler._afterOnEnable += value;
                HookHandler.HookOnEnable();
            }
            remove => HookHandler._afterOnEnable -= value;
        }

        public static event Delegates.OnDisable_NormalArgs OnDisable
        {
            add
            {
                HookHandler._afterOnDisable += value;
                HookHandler.HookOnDisable();
            }
            remove => HookHandler._afterOnDisable -= value;
        }

        public static event Delegates.OnTransformParentChanged_NormalArgs OnTransformParentChanged
        {
            add
            {
                HookHandler._afterOnTransformParentChanged += value;
                HookHandler.HookOnTransformParentChanged();
            }
            remove => HookHandler._afterOnTransformParentChanged -= value;
        }

        public static event Delegates.OnRectTransformDimensionsChange_NormalArgs OnRectTransformDimensionsChange
        {
            add
            {
                HookHandler._afterOnRectTransformDimensionsChange += value;
                HookHandler.HookOnRectTransformDimensionsChange();
            }
            remove => HookHandler._afterOnRectTransformDimensionsChange -= value;
        }

        public static event Delegates.UpdateMaterial_NormalArgs UpdateMaterial
        {
            add
            {
                HookHandler._afterUpdateMaterial += value;
                HookHandler.HookUpdateMaterial();
            }
            remove => HookHandler._afterUpdateMaterial -= value;
        }

        public static event Delegates.UpdateGeometry_NormalArgs UpdateGeometry
        {
            add
            {
                HookHandler._afterUpdateGeometry += value;
                HookHandler.HookUpdateGeometry();
            }
            remove => HookHandler._afterUpdateGeometry -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event Delegates.get_mainTexture_NormalArgs get_mainTexture
        {
            add => HookEndpointManager.Add<Delegates.get_mainTexture_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "get_mainTexture"), value);
            remove => HookEndpointManager.Remove<Delegates.get_mainTexture_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "get_mainTexture"), value);
        }

        public static event Delegates.Awake_NormalArgs Awake
        {
            add => HookEndpointManager.Add<Delegates.Awake_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "Awake"), value);
            remove => HookEndpointManager.Remove<Delegates.Awake_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "Awake"), value);
        }

        public static event Delegates.OnEnable_NormalArgs OnEnable
        {
            add => HookEndpointManager.Add<Delegates.OnEnable_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnEnable"), value);
            remove => HookEndpointManager.Remove<Delegates.OnEnable_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnEnable"), value);
        }

        public static event Delegates.OnDisable_NormalArgs OnDisable
        {
            add => HookEndpointManager.Add<Delegates.OnDisable_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnDisable"), value);
            remove => HookEndpointManager.Remove<Delegates.OnDisable_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnDisable"), value);
        }

        public static event Delegates.OnTransformParentChanged_NormalArgs OnTransformParentChanged
        {
            add => HookEndpointManager.Add<Delegates.OnTransformParentChanged_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnTransformParentChanged"), value);
            remove => HookEndpointManager.Remove<Delegates.OnTransformParentChanged_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnTransformParentChanged"), value);
        }

        public static event Delegates.OnRectTransformDimensionsChange_NormalArgs OnRectTransformDimensionsChange
        {
            add => HookEndpointManager.Add<Delegates.OnRectTransformDimensionsChange_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnRectTransformDimensionsChange"), value);
            remove => HookEndpointManager.Remove<Delegates.OnRectTransformDimensionsChange_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "OnRectTransformDimensionsChange"), value);
        }

        public static event Delegates.UpdateMaterial_NormalArgs UpdateMaterial
        {
            add => HookEndpointManager.Add<Delegates.UpdateMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateMaterial"), value);
            remove => HookEndpointManager.Remove<Delegates.UpdateMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateMaterial"), value);
        }

        public static event Delegates.UpdateGeometry_NormalArgs UpdateGeometry
        {
            add => HookEndpointManager.Add<Delegates.UpdateGeometry_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateGeometry"), value);
            remove => HookEndpointManager.Remove<Delegates.UpdateGeometry_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(InlineGraphic), "UpdateGeometry"), value);
        }
    }
}