using MonoMod.RuntimeDetour;
using MonoMod.RuntimeDetour.HookGen;

namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for tk2dUIMask class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class Ontk2dUIMask
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void Hookget_ThisMeshFilter()
        {
            if (!HookedList.Contains("get_ThisMeshFilter"))
            {
                HookedList.Add("get_ThisMeshFilter");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisMeshFilter"), get_ThisMeshFilter);
            }
        }

        internal static event Delegates.get_ThisMeshFilter_BeforeArgs _beforeget_ThisMeshFilter;
        internal static event Delegates.get_ThisMeshFilter_NormalArgs _afterget_ThisMeshFilter;

        private static MeshFilter get_ThisMeshFilter(Func<tk2dUIMask, MeshFilter> orig, tk2dUIMask self)
        {
            Delegates.Params_get_ThisMeshFilter @params = new()
            {
                self = self
            };
            _beforeget_ThisMeshFilter?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_ThisMeshFilter != null) retVal = _afterget_ThisMeshFilter.Invoke(@params);
            return retVal;
        }

        internal static void Hookget_ThisBoxCollider()
        {
            if (!HookedList.Contains("get_ThisBoxCollider"))
            {
                HookedList.Add("get_ThisBoxCollider");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisBoxCollider"),
                    get_ThisBoxCollider);
            }
        }

        internal static event Delegates.get_ThisBoxCollider_BeforeArgs _beforeget_ThisBoxCollider;
        internal static event Delegates.get_ThisBoxCollider_NormalArgs _afterget_ThisBoxCollider;

        private static BoxCollider get_ThisBoxCollider(Func<tk2dUIMask, BoxCollider> orig, tk2dUIMask self)
        {
            Delegates.Params_get_ThisBoxCollider @params = new()
            {
                self = self
            };
            _beforeget_ThisBoxCollider?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_ThisBoxCollider != null) retVal = _afterget_ThisBoxCollider.Invoke(@params);
            return retVal;
        }

        internal static void HookAwake()
        {
            if (!HookedList.Contains("Awake"))
            {
                HookedList.Add("Awake");
                On.tk2dUIMask.Awake += Awake;
            }
        }

        internal static event Delegates.Awake_BeforeArgs _beforeAwake;
        internal static event Delegates.Awake_NormalArgs _afterAwake;

        private static void Awake(On.tk2dUIMask.orig_Awake orig, tk2dUIMask self)
        {
            Delegates.Params_Awake @params = new()
            {
                self = self
            };
            _beforeAwake?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterAwake != null) _afterAwake.Invoke(@params);
        }

        internal static void HookOnDestroy()
        {
            if (!HookedList.Contains("OnDestroy"))
            {
                HookedList.Add("OnDestroy");
                On.tk2dUIMask.OnDestroy += OnDestroy;
            }
        }

        internal static event Delegates.OnDestroy_BeforeArgs _beforeOnDestroy;
        internal static event Delegates.OnDestroy_NormalArgs _afterOnDestroy;

        private static void OnDestroy(On.tk2dUIMask.orig_OnDestroy orig, tk2dUIMask self)
        {
            Delegates.Params_OnDestroy @params = new()
            {
                self = self
            };
            _beforeOnDestroy?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnDestroy != null) _afterOnDestroy.Invoke(@params);
        }

        internal static void HookFillMesh()
        {
            if (!HookedList.Contains("FillMesh"))
            {
                HookedList.Add("FillMesh");
                On.tk2dUIMask.FillMesh += FillMesh;
            }
        }

        internal static event Delegates.FillMesh_BeforeArgs _beforeFillMesh;
        internal static event Delegates.FillMesh_NormalArgs _afterFillMesh;

        private static Mesh FillMesh(On.tk2dUIMask.orig_FillMesh orig, tk2dUIMask self, Mesh mesh)
        {
            Delegates.Params_FillMesh @params = new()
            {
                self = self, mesh = mesh
            };
            _beforeFillMesh?.Invoke(@params);
            self = @params.self;
            mesh = @params.mesh;
            var retVal = orig(self, mesh);
            if (_afterFillMesh != null) retVal = _afterFillMesh.Invoke(@params);
            return retVal;
        }

        internal static void HookOnDrawGizmosSelected()
        {
            if (!HookedList.Contains("OnDrawGizmosSelected"))
            {
                HookedList.Add("OnDrawGizmosSelected");
                On.tk2dUIMask.OnDrawGizmosSelected += OnDrawGizmosSelected;
            }
        }

        internal static event Delegates.OnDrawGizmosSelected_BeforeArgs _beforeOnDrawGizmosSelected;
        internal static event Delegates.OnDrawGizmosSelected_NormalArgs _afterOnDrawGizmosSelected;

        private static void OnDrawGizmosSelected(On.tk2dUIMask.orig_OnDrawGizmosSelected orig, tk2dUIMask self)
        {
            Delegates.Params_OnDrawGizmosSelected @params = new()
            {
                self = self
            };
            _beforeOnDrawGizmosSelected?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnDrawGizmosSelected != null) _afterOnDrawGizmosSelected.Invoke(@params);
        }

        internal static void HookBuild()
        {
            if (!HookedList.Contains("Build"))
            {
                HookedList.Add("Build");
                On.tk2dUIMask.Build += Build;
            }
        }

        internal static event Delegates.Build_BeforeArgs _beforeBuild;
        internal static event Delegates.Build_NormalArgs _afterBuild;

        private static void Build(On.tk2dUIMask.orig_Build orig, tk2dUIMask self)
        {
            Delegates.Params_Build @params = new()
            {
                self = self
            };
            _beforeBuild?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterBuild != null) _afterBuild.Invoke(@params);
        }

        internal static void HookReshapeBounds()
        {
            if (!HookedList.Contains("ReshapeBounds"))
            {
                HookedList.Add("ReshapeBounds");
                On.tk2dUIMask.ReshapeBounds += ReshapeBounds;
            }
        }

        internal static event Delegates.ReshapeBounds_BeforeArgs _beforeReshapeBounds;
        internal static event Delegates.ReshapeBounds_NormalArgs _afterReshapeBounds;

        private static void ReshapeBounds(On.tk2dUIMask.orig_ReshapeBounds orig, tk2dUIMask self, Vector3 dMin,
            Vector3 dMax)
        {
            Delegates.Params_ReshapeBounds @params = new()
            {
                self = self, dMin = dMin, dMax = dMax
            };
            _beforeReshapeBounds?.Invoke(@params);
            self = @params.self;
            dMin = @params.dMin;
            dMax = @params.dMax;
            orig(self, dMin, dMax);
            if (_afterReshapeBounds != null) _afterReshapeBounds.Invoke(@params);
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void Awake_BeforeArgs(Params_Awake args);

        public delegate void Awake_NormalArgs(Params_Awake args);

        public delegate void Build_BeforeArgs(Params_Build args);

        public delegate void Build_NormalArgs(Params_Build args);

        public delegate void FillMesh_BeforeArgs(Params_FillMesh args);

        public delegate Mesh FillMesh_NormalArgs(Params_FillMesh args);

        public delegate void get_ThisBoxCollider_BeforeArgs(Params_get_ThisBoxCollider args);

        public delegate BoxCollider get_ThisBoxCollider_NormalArgs(Params_get_ThisBoxCollider args);

        public delegate void get_ThisMeshFilter_BeforeArgs(Params_get_ThisMeshFilter args);

        public delegate MeshFilter get_ThisMeshFilter_NormalArgs(Params_get_ThisMeshFilter args);

        public delegate void OnDestroy_BeforeArgs(Params_OnDestroy args);

        public delegate void OnDestroy_NormalArgs(Params_OnDestroy args);

        public delegate void OnDrawGizmosSelected_BeforeArgs(Params_OnDrawGizmosSelected args);

        public delegate void OnDrawGizmosSelected_NormalArgs(Params_OnDrawGizmosSelected args);

        public delegate void ReshapeBounds_BeforeArgs(Params_ReshapeBounds args);

        public delegate void ReshapeBounds_NormalArgs(Params_ReshapeBounds args);

        public sealed class Params_get_ThisMeshFilter
        {
            public tk2dUIMask self;
        }

        public sealed class Params_get_ThisBoxCollider
        {
            public tk2dUIMask self;
        }

        public sealed class Params_Awake
        {
            public tk2dUIMask self;
        }

        public sealed class Params_OnDestroy
        {
            public tk2dUIMask self;
        }

        public sealed class Params_FillMesh
        {
            public Mesh mesh;
            public tk2dUIMask self;
        }

        public sealed class Params_OnDrawGizmosSelected
        {
            public tk2dUIMask self;
        }

        public sealed class Params_Build
        {
            public tk2dUIMask self;
        }

        public sealed class Params_ReshapeBounds
        {
            public Vector3 dMax;
            public Vector3 dMin;
            public tk2dUIMask self;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.get_ThisMeshFilter_BeforeArgs get_ThisMeshFilter
        {
            add
            {
                HookHandler._beforeget_ThisMeshFilter += value;
                HookHandler.Hookget_ThisMeshFilter();
            }
            remove => HookHandler._beforeget_ThisMeshFilter -= value;
        }

        public static event Delegates.get_ThisBoxCollider_BeforeArgs get_ThisBoxCollider
        {
            add
            {
                HookHandler._beforeget_ThisBoxCollider += value;
                HookHandler.Hookget_ThisBoxCollider();
            }
            remove => HookHandler._beforeget_ThisBoxCollider -= value;
        }

        public static event Delegates.Awake_BeforeArgs Awake
        {
            add
            {
                HookHandler._beforeAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._beforeAwake -= value;
        }

        public static event Delegates.OnDestroy_BeforeArgs OnDestroy
        {
            add
            {
                HookHandler._beforeOnDestroy += value;
                HookHandler.HookOnDestroy();
            }
            remove => HookHandler._beforeOnDestroy -= value;
        }

        public static event Delegates.FillMesh_BeforeArgs FillMesh
        {
            add
            {
                HookHandler._beforeFillMesh += value;
                HookHandler.HookFillMesh();
            }
            remove => HookHandler._beforeFillMesh -= value;
        }

        public static event Delegates.OnDrawGizmosSelected_BeforeArgs OnDrawGizmosSelected
        {
            add
            {
                HookHandler._beforeOnDrawGizmosSelected += value;
                HookHandler.HookOnDrawGizmosSelected();
            }
            remove => HookHandler._beforeOnDrawGizmosSelected -= value;
        }

        public static event Delegates.Build_BeforeArgs Build
        {
            add
            {
                HookHandler._beforeBuild += value;
                HookHandler.HookBuild();
            }
            remove => HookHandler._beforeBuild -= value;
        }

        public static event Delegates.ReshapeBounds_BeforeArgs ReshapeBounds
        {
            add
            {
                HookHandler._beforeReshapeBounds += value;
                HookHandler.HookReshapeBounds();
            }
            remove => HookHandler._beforeReshapeBounds -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.get_ThisMeshFilter_NormalArgs get_ThisMeshFilter
        {
            add
            {
                HookHandler._afterget_ThisMeshFilter += value;
                HookHandler.Hookget_ThisMeshFilter();
            }
            remove => HookHandler._afterget_ThisMeshFilter -= value;
        }

        public static event Delegates.get_ThisBoxCollider_NormalArgs get_ThisBoxCollider
        {
            add
            {
                HookHandler._afterget_ThisBoxCollider += value;
                HookHandler.Hookget_ThisBoxCollider();
            }
            remove => HookHandler._afterget_ThisBoxCollider -= value;
        }

        public static event Delegates.Awake_NormalArgs Awake
        {
            add
            {
                HookHandler._afterAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._afterAwake -= value;
        }

        public static event Delegates.OnDestroy_NormalArgs OnDestroy
        {
            add
            {
                HookHandler._afterOnDestroy += value;
                HookHandler.HookOnDestroy();
            }
            remove => HookHandler._afterOnDestroy -= value;
        }

        public static event Delegates.FillMesh_NormalArgs FillMesh
        {
            add
            {
                HookHandler._afterFillMesh += value;
                HookHandler.HookFillMesh();
            }
            remove => HookHandler._afterFillMesh -= value;
        }

        public static event Delegates.OnDrawGizmosSelected_NormalArgs OnDrawGizmosSelected
        {
            add
            {
                HookHandler._afterOnDrawGizmosSelected += value;
                HookHandler.HookOnDrawGizmosSelected();
            }
            remove => HookHandler._afterOnDrawGizmosSelected -= value;
        }

        public static event Delegates.Build_NormalArgs Build
        {
            add
            {
                HookHandler._afterBuild += value;
                HookHandler.HookBuild();
            }
            remove => HookHandler._afterBuild -= value;
        }

        public static event Delegates.ReshapeBounds_NormalArgs ReshapeBounds
        {
            add
            {
                HookHandler._afterReshapeBounds += value;
                HookHandler.HookReshapeBounds();
            }
            remove => HookHandler._afterReshapeBounds -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event Delegates.get_ThisMeshFilter_NormalArgs get_ThisMeshFilter
        {
            add => HookEndpointManager.Add<Delegates.get_ThisMeshFilter_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisMeshFilter"), value);
            remove => HookEndpointManager.Remove<Delegates.get_ThisMeshFilter_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisMeshFilter"), value);
        }

        public static event Delegates.get_ThisBoxCollider_NormalArgs get_ThisBoxCollider
        {
            add => HookEndpointManager.Add<Delegates.get_ThisBoxCollider_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisBoxCollider"), value);
            remove => HookEndpointManager.Remove<Delegates.get_ThisBoxCollider_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(tk2dUIMask), "get_ThisBoxCollider"), value);
        }

        public static event On.tk2dUIMask.hook_Awake Awake
        {
            add => On.tk2dUIMask.Awake += value;
            remove => On.tk2dUIMask.Awake -= value;
        }

        public static event On.tk2dUIMask.hook_OnDestroy OnDestroy
        {
            add => On.tk2dUIMask.OnDestroy += value;
            remove => On.tk2dUIMask.OnDestroy -= value;
        }

        public static event On.tk2dUIMask.hook_FillMesh FillMesh
        {
            add => On.tk2dUIMask.FillMesh += value;
            remove => On.tk2dUIMask.FillMesh -= value;
        }

        public static event On.tk2dUIMask.hook_OnDrawGizmosSelected OnDrawGizmosSelected
        {
            add => On.tk2dUIMask.OnDrawGizmosSelected += value;
            remove => On.tk2dUIMask.OnDrawGizmosSelected -= value;
        }

        public static event On.tk2dUIMask.hook_Build Build
        {
            add => On.tk2dUIMask.Build += value;
            remove => On.tk2dUIMask.Build -= value;
        }

        public static event On.tk2dUIMask.hook_ReshapeBounds ReshapeBounds
        {
            add => On.tk2dUIMask.ReshapeBounds += value;
            remove => On.tk2dUIMask.ReshapeBounds -= value;
        }
    }
}