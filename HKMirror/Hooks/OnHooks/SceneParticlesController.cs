namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for SceneParticlesController class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class OnSceneParticlesController
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void HookSceneInit()
        {
            if (!HookedList.Contains("SceneInit"))
            {
                HookedList.Add("SceneInit");
                On.SceneParticlesController.SceneInit += SceneInit;
            }
        }

        internal static event Delegates.SceneInit_BeforeArgs _beforeSceneInit;
        internal static event Delegates.SceneInit_NormalArgs _afterSceneInit;

        private static void SceneInit(On.SceneParticlesController.orig_SceneInit orig, SceneParticlesController self)
        {
            Delegates.Params_SceneInit @params = new()
            {
                self = self
            };
            _beforeSceneInit?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterSceneInit != null) _afterSceneInit.Invoke(@params);
        }

        internal static void HookEnableParticles()
        {
            if (!HookedList.Contains("EnableParticles"))
            {
                HookedList.Add("EnableParticles");
                On.SceneParticlesController.EnableParticles += EnableParticles;
            }
        }

        internal static event Delegates.EnableParticles_BeforeArgs _beforeEnableParticles;
        internal static event Delegates.EnableParticles_NormalArgs _afterEnableParticles;

        private static void EnableParticles(On.SceneParticlesController.orig_EnableParticles orig,
            SceneParticlesController self)
        {
            Delegates.Params_EnableParticles @params = new()
            {
                self = self
            };
            _beforeEnableParticles?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterEnableParticles != null) _afterEnableParticles.Invoke(@params);
        }

        internal static void HookDisableParticles()
        {
            if (!HookedList.Contains("DisableParticles"))
            {
                HookedList.Add("DisableParticles");
                On.SceneParticlesController.DisableParticles += DisableParticles;
            }
        }

        internal static event Delegates.DisableParticles_BeforeArgs _beforeDisableParticles;
        internal static event Delegates.DisableParticles_NormalArgs _afterDisableParticles;

        private static void DisableParticles(On.SceneParticlesController.orig_DisableParticles orig,
            SceneParticlesController self)
        {
            Delegates.Params_DisableParticles @params = new()
            {
                self = self
            };
            _beforeDisableParticles?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterDisableParticles != null) _afterDisableParticles.Invoke(@params);
        }

        internal static void HookBeginScene()
        {
            if (!HookedList.Contains("BeginScene"))
            {
                HookedList.Add("BeginScene");
                On.SceneParticlesController.BeginScene += BeginScene;
            }
        }

        internal static event Delegates.BeginScene_BeforeArgs _beforeBeginScene;
        internal static event Delegates.BeginScene_NormalArgs _afterBeginScene;

        private static void BeginScene(On.SceneParticlesController.orig_BeginScene orig, SceneParticlesController self)
        {
            Delegates.Params_BeginScene @params = new()
            {
                self = self
            };
            _beforeBeginScene?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterBeginScene != null) _afterBeginScene.Invoke(@params);
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void BeginScene_BeforeArgs(Params_BeginScene args);

        public delegate void BeginScene_NormalArgs(Params_BeginScene args);

        public delegate void DisableParticles_BeforeArgs(Params_DisableParticles args);

        public delegate void DisableParticles_NormalArgs(Params_DisableParticles args);

        public delegate void EnableParticles_BeforeArgs(Params_EnableParticles args);

        public delegate void EnableParticles_NormalArgs(Params_EnableParticles args);

        public delegate void SceneInit_BeforeArgs(Params_SceneInit args);

        public delegate void SceneInit_NormalArgs(Params_SceneInit args);

        public sealed class Params_SceneInit
        {
            public SceneParticlesController self;
        }

        public sealed class Params_EnableParticles
        {
            public SceneParticlesController self;
        }

        public sealed class Params_DisableParticles
        {
            public SceneParticlesController self;
        }

        public sealed class Params_BeginScene
        {
            public SceneParticlesController self;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.SceneInit_BeforeArgs SceneInit
        {
            add
            {
                HookHandler._beforeSceneInit += value;
                HookHandler.HookSceneInit();
            }
            remove => HookHandler._beforeSceneInit -= value;
        }

        public static event Delegates.EnableParticles_BeforeArgs EnableParticles
        {
            add
            {
                HookHandler._beforeEnableParticles += value;
                HookHandler.HookEnableParticles();
            }
            remove => HookHandler._beforeEnableParticles -= value;
        }

        public static event Delegates.DisableParticles_BeforeArgs DisableParticles
        {
            add
            {
                HookHandler._beforeDisableParticles += value;
                HookHandler.HookDisableParticles();
            }
            remove => HookHandler._beforeDisableParticles -= value;
        }

        public static event Delegates.BeginScene_BeforeArgs BeginScene
        {
            add
            {
                HookHandler._beforeBeginScene += value;
                HookHandler.HookBeginScene();
            }
            remove => HookHandler._beforeBeginScene -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.SceneInit_NormalArgs SceneInit
        {
            add
            {
                HookHandler._afterSceneInit += value;
                HookHandler.HookSceneInit();
            }
            remove => HookHandler._afterSceneInit -= value;
        }

        public static event Delegates.EnableParticles_NormalArgs EnableParticles
        {
            add
            {
                HookHandler._afterEnableParticles += value;
                HookHandler.HookEnableParticles();
            }
            remove => HookHandler._afterEnableParticles -= value;
        }

        public static event Delegates.DisableParticles_NormalArgs DisableParticles
        {
            add
            {
                HookHandler._afterDisableParticles += value;
                HookHandler.HookDisableParticles();
            }
            remove => HookHandler._afterDisableParticles -= value;
        }

        public static event Delegates.BeginScene_NormalArgs BeginScene
        {
            add
            {
                HookHandler._afterBeginScene += value;
                HookHandler.HookBeginScene();
            }
            remove => HookHandler._afterBeginScene -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event On.SceneParticlesController.hook_SceneInit SceneInit
        {
            add => On.SceneParticlesController.SceneInit += value;
            remove => On.SceneParticlesController.SceneInit -= value;
        }

        public static event On.SceneParticlesController.hook_EnableParticles EnableParticles
        {
            add => On.SceneParticlesController.EnableParticles += value;
            remove => On.SceneParticlesController.EnableParticles -= value;
        }

        public static event On.SceneParticlesController.hook_DisableParticles DisableParticles
        {
            add => On.SceneParticlesController.DisableParticles += value;
            remove => On.SceneParticlesController.DisableParticles -= value;
        }

        public static event On.SceneParticlesController.hook_BeginScene BeginScene
        {
            add => On.SceneParticlesController.BeginScene += value;
            remove => On.SceneParticlesController.BeginScene -= value;
        }
    }
}