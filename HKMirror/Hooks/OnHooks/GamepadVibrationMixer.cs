using MonoMod.RuntimeDetour;
using MonoMod.RuntimeDetour.HookGen;

namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for GamepadVibrationMixer class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class OnGamepadVibrationMixer
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void Hookget_IsPaused()
        {
            if (!HookedList.Contains("get_IsPaused"))
            {
                HookedList.Add("get_IsPaused");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_IsPaused"), get_IsPaused);
            }
        }

        internal static event Delegates.get_IsPaused_BeforeArgs _beforeget_IsPaused;
        internal static event Delegates.get_IsPaused_NormalArgs _afterget_IsPaused;

        private static bool get_IsPaused(Func<GamepadVibrationMixer, bool> orig, GamepadVibrationMixer self)
        {
            Delegates.Params_get_IsPaused @params = new()
            {
                self = self
            };
            _beforeget_IsPaused?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_IsPaused != null) retVal = _afterget_IsPaused.Invoke(@params);
            return retVal;
        }

        internal static void Hookset_IsPaused()
        {
            if (!HookedList.Contains("set_IsPaused"))
            {
                HookedList.Add("set_IsPaused");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "set_IsPaused"), set_IsPaused);
            }
        }

        internal static event Delegates.set_IsPaused_BeforeArgs _beforeset_IsPaused;
        internal static event Delegates.set_IsPaused_NormalArgs _afterset_IsPaused;

        private static void set_IsPaused(Action<GamepadVibrationMixer, bool> orig, GamepadVibrationMixer self,
            bool value)
        {
            Delegates.Params_set_IsPaused @params = new()
            {
                self = self, value = value
            };
            _beforeset_IsPaused?.Invoke(@params);
            self = @params.self;
            value = @params.value;
            orig(self, value);
            if (_afterset_IsPaused != null) _afterset_IsPaused.Invoke(@params);
        }

        internal static void Hookget_PlayingEmissionCount()
        {
            if (!HookedList.Contains("get_PlayingEmissionCount"))
            {
                HookedList.Add("get_PlayingEmissionCount");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_PlayingEmissionCount"),
                    get_PlayingEmissionCount);
            }
        }

        internal static event Delegates.get_PlayingEmissionCount_BeforeArgs _beforeget_PlayingEmissionCount;
        internal static event Delegates.get_PlayingEmissionCount_NormalArgs _afterget_PlayingEmissionCount;

        private static int get_PlayingEmissionCount(Func<GamepadVibrationMixer, int> orig, GamepadVibrationMixer self)
        {
            Delegates.Params_get_PlayingEmissionCount @params = new()
            {
                self = self
            };
            _beforeget_PlayingEmissionCount?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_PlayingEmissionCount != null) retVal = _afterget_PlayingEmissionCount.Invoke(@params);
            return retVal;
        }

        internal static void HookGetPlayingEmission()
        {
            if (!HookedList.Contains("GetPlayingEmission"))
            {
                HookedList.Add("GetPlayingEmission");
                On.GamepadVibrationMixer.GetPlayingEmission += GetPlayingEmission;
            }
        }

        internal static event Delegates.GetPlayingEmission_BeforeArgs _beforeGetPlayingEmission;
        internal static event Delegates.GetPlayingEmission_NormalArgs _afterGetPlayingEmission;

        private static VibrationEmission GetPlayingEmission(On.GamepadVibrationMixer.orig_GetPlayingEmission orig,
            GamepadVibrationMixer self, int playingEmissionIndex)
        {
            Delegates.Params_GetPlayingEmission @params = new()
            {
                self = self, playingEmissionIndex = playingEmissionIndex
            };
            _beforeGetPlayingEmission?.Invoke(@params);
            self = @params.self;
            playingEmissionIndex = @params.playingEmissionIndex;
            var retVal = orig(self, playingEmissionIndex);
            if (_afterGetPlayingEmission != null) retVal = _afterGetPlayingEmission.Invoke(@params);
            return retVal;
        }

        internal static void HookPlayEmission()
        {
            if (!HookedList.Contains("PlayEmission"))
            {
                HookedList.Add("PlayEmission");
                On.GamepadVibrationMixer.PlayEmission += PlayEmission;
            }
        }

        internal static event Delegates.PlayEmission_BeforeArgs _beforePlayEmission;
        internal static event Delegates.PlayEmission_NormalArgs _afterPlayEmission;

        private static VibrationEmission PlayEmission(On.GamepadVibrationMixer.orig_PlayEmission orig,
            GamepadVibrationMixer self, VibrationData vibrationData, VibrationTarget vibrationTarget, bool isLooping,
            string tag)
        {
            Delegates.Params_PlayEmission @params = new()
            {
                self = self, vibrationData = vibrationData, vibrationTarget = vibrationTarget, isLooping = isLooping,
                tag = tag
            };
            _beforePlayEmission?.Invoke(@params);
            self = @params.self;
            vibrationData = @params.vibrationData;
            vibrationTarget = @params.vibrationTarget;
            isLooping = @params.isLooping;
            tag = @params.tag;
            var retVal = orig(self, vibrationData, vibrationTarget, isLooping, tag);
            if (_afterPlayEmission != null) retVal = _afterPlayEmission.Invoke(@params);
            return retVal;
        }

        internal static void HookStopAllEmissions()
        {
            if (!HookedList.Contains("StopAllEmissions"))
            {
                HookedList.Add("StopAllEmissions");
                On.GamepadVibrationMixer.StopAllEmissions += StopAllEmissions;
            }
        }

        internal static event Delegates.StopAllEmissions_BeforeArgs _beforeStopAllEmissions;
        internal static event Delegates.StopAllEmissions_NormalArgs _afterStopAllEmissions;

        private static void StopAllEmissions(On.GamepadVibrationMixer.orig_StopAllEmissions orig,
            GamepadVibrationMixer self)
        {
            Delegates.Params_StopAllEmissions @params = new()
            {
                self = self
            };
            _beforeStopAllEmissions?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterStopAllEmissions != null) _afterStopAllEmissions.Invoke(@params);
        }

        internal static void HookStopAllEmissionsWithTag()
        {
            if (!HookedList.Contains("StopAllEmissionsWithTag"))
            {
                HookedList.Add("StopAllEmissionsWithTag");
                On.GamepadVibrationMixer.StopAllEmissionsWithTag += StopAllEmissionsWithTag;
            }
        }

        internal static event Delegates.StopAllEmissionsWithTag_BeforeArgs _beforeStopAllEmissionsWithTag;
        internal static event Delegates.StopAllEmissionsWithTag_NormalArgs _afterStopAllEmissionsWithTag;

        private static void StopAllEmissionsWithTag(On.GamepadVibrationMixer.orig_StopAllEmissionsWithTag orig,
            GamepadVibrationMixer self, string tag)
        {
            Delegates.Params_StopAllEmissionsWithTag @params = new()
            {
                self = self, tag = tag
            };
            _beforeStopAllEmissionsWithTag?.Invoke(@params);
            self = @params.self;
            tag = @params.tag;
            orig(self, tag);
            if (_afterStopAllEmissionsWithTag != null) _afterStopAllEmissionsWithTag.Invoke(@params);
        }

        internal static void HookUpdate()
        {
            if (!HookedList.Contains("Update"))
            {
                HookedList.Add("Update");
                On.GamepadVibrationMixer.Update += Update;
            }
        }

        internal static event Delegates.Update_BeforeArgs _beforeUpdate;
        internal static event Delegates.Update_NormalArgs _afterUpdate;

        private static void Update(On.GamepadVibrationMixer.orig_Update orig, GamepadVibrationMixer self,
            float deltaTime)
        {
            Delegates.Params_Update @params = new()
            {
                self = self, deltaTime = deltaTime
            };
            _beforeUpdate?.Invoke(@params);
            self = @params.self;
            deltaTime = @params.deltaTime;
            orig(self, deltaTime);
            if (_afterUpdate != null) _afterUpdate.Invoke(@params);
        }

        internal static void HookAdjustForPlatform()
        {
            if (!HookedList.Contains("AdjustForPlatform"))
            {
                HookedList.Add("AdjustForPlatform");
                On.GamepadVibrationMixer.AdjustForPlatform += AdjustForPlatform;
            }
        }

        internal static event Delegates.AdjustForPlatform_BeforeArgs _beforeAdjustForPlatform;
        internal static event Delegates.AdjustForPlatform_NormalArgs _afterAdjustForPlatform;

        private static float AdjustForPlatform(On.GamepadVibrationMixer.orig_AdjustForPlatform orig,
            GamepadVibrationMixer self, float val)
        {
            Delegates.Params_AdjustForPlatform @params = new()
            {
                self = self, val = val
            };
            _beforeAdjustForPlatform?.Invoke(@params);
            self = @params.self;
            val = @params.val;
            var retVal = orig(self, val);
            if (_afterAdjustForPlatform != null) retVal = _afterAdjustForPlatform.Invoke(@params);
            return retVal;
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void AdjustForPlatform_BeforeArgs(Params_AdjustForPlatform args);

        public delegate float AdjustForPlatform_NormalArgs(Params_AdjustForPlatform args);

        public delegate void get_IsPaused_BeforeArgs(Params_get_IsPaused args);

        public delegate bool get_IsPaused_NormalArgs(Params_get_IsPaused args);

        public delegate void get_PlayingEmissionCount_BeforeArgs(Params_get_PlayingEmissionCount args);

        public delegate int get_PlayingEmissionCount_NormalArgs(Params_get_PlayingEmissionCount args);

        public delegate void GetPlayingEmission_BeforeArgs(Params_GetPlayingEmission args);

        public delegate VibrationEmission GetPlayingEmission_NormalArgs(Params_GetPlayingEmission args);

        public delegate void PlayEmission_BeforeArgs(Params_PlayEmission args);

        public delegate VibrationEmission PlayEmission_NormalArgs(Params_PlayEmission args);

        public delegate void set_IsPaused_BeforeArgs(Params_set_IsPaused args);

        public delegate void set_IsPaused_NormalArgs(Params_set_IsPaused args);

        public delegate void StopAllEmissions_BeforeArgs(Params_StopAllEmissions args);

        public delegate void StopAllEmissions_NormalArgs(Params_StopAllEmissions args);

        public delegate void StopAllEmissionsWithTag_BeforeArgs(Params_StopAllEmissionsWithTag args);

        public delegate void StopAllEmissionsWithTag_NormalArgs(Params_StopAllEmissionsWithTag args);

        public delegate void Update_BeforeArgs(Params_Update args);

        public delegate void Update_NormalArgs(Params_Update args);

        public sealed class Params_get_IsPaused
        {
            public GamepadVibrationMixer self;
        }

        public sealed class Params_set_IsPaused
        {
            public GamepadVibrationMixer self;
            public bool value;
        }

        public sealed class Params_get_PlayingEmissionCount
        {
            public GamepadVibrationMixer self;
        }

        public sealed class Params_GetPlayingEmission
        {
            public int playingEmissionIndex;
            public GamepadVibrationMixer self;
        }

        public sealed class Params_PlayEmission
        {
            public bool isLooping;
            public GamepadVibrationMixer self;
            public string tag;
            public VibrationData vibrationData;
            public VibrationTarget vibrationTarget;
        }

        public sealed class Params_StopAllEmissions
        {
            public GamepadVibrationMixer self;
        }

        public sealed class Params_StopAllEmissionsWithTag
        {
            public GamepadVibrationMixer self;
            public string tag;
        }

        public sealed class Params_Update
        {
            public float deltaTime;
            public GamepadVibrationMixer self;
        }

        public sealed class Params_AdjustForPlatform
        {
            public GamepadVibrationMixer self;
            public float val;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.get_IsPaused_BeforeArgs get_IsPaused
        {
            add
            {
                HookHandler._beforeget_IsPaused += value;
                HookHandler.Hookget_IsPaused();
            }
            remove => HookHandler._beforeget_IsPaused -= value;
        }

        public static event Delegates.set_IsPaused_BeforeArgs set_IsPaused
        {
            add
            {
                HookHandler._beforeset_IsPaused += value;
                HookHandler.Hookset_IsPaused();
            }
            remove => HookHandler._beforeset_IsPaused -= value;
        }

        public static event Delegates.get_PlayingEmissionCount_BeforeArgs get_PlayingEmissionCount
        {
            add
            {
                HookHandler._beforeget_PlayingEmissionCount += value;
                HookHandler.Hookget_PlayingEmissionCount();
            }
            remove => HookHandler._beforeget_PlayingEmissionCount -= value;
        }

        public static event Delegates.GetPlayingEmission_BeforeArgs GetPlayingEmission
        {
            add
            {
                HookHandler._beforeGetPlayingEmission += value;
                HookHandler.HookGetPlayingEmission();
            }
            remove => HookHandler._beforeGetPlayingEmission -= value;
        }

        public static event Delegates.PlayEmission_BeforeArgs PlayEmission
        {
            add
            {
                HookHandler._beforePlayEmission += value;
                HookHandler.HookPlayEmission();
            }
            remove => HookHandler._beforePlayEmission -= value;
        }

        public static event Delegates.StopAllEmissions_BeforeArgs StopAllEmissions
        {
            add
            {
                HookHandler._beforeStopAllEmissions += value;
                HookHandler.HookStopAllEmissions();
            }
            remove => HookHandler._beforeStopAllEmissions -= value;
        }

        public static event Delegates.StopAllEmissionsWithTag_BeforeArgs StopAllEmissionsWithTag
        {
            add
            {
                HookHandler._beforeStopAllEmissionsWithTag += value;
                HookHandler.HookStopAllEmissionsWithTag();
            }
            remove => HookHandler._beforeStopAllEmissionsWithTag -= value;
        }

        public static event Delegates.Update_BeforeArgs Update
        {
            add
            {
                HookHandler._beforeUpdate += value;
                HookHandler.HookUpdate();
            }
            remove => HookHandler._beforeUpdate -= value;
        }

        public static event Delegates.AdjustForPlatform_BeforeArgs AdjustForPlatform
        {
            add
            {
                HookHandler._beforeAdjustForPlatform += value;
                HookHandler.HookAdjustForPlatform();
            }
            remove => HookHandler._beforeAdjustForPlatform -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.get_IsPaused_NormalArgs get_IsPaused
        {
            add
            {
                HookHandler._afterget_IsPaused += value;
                HookHandler.Hookget_IsPaused();
            }
            remove => HookHandler._afterget_IsPaused -= value;
        }

        public static event Delegates.set_IsPaused_NormalArgs set_IsPaused
        {
            add
            {
                HookHandler._afterset_IsPaused += value;
                HookHandler.Hookset_IsPaused();
            }
            remove => HookHandler._afterset_IsPaused -= value;
        }

        public static event Delegates.get_PlayingEmissionCount_NormalArgs get_PlayingEmissionCount
        {
            add
            {
                HookHandler._afterget_PlayingEmissionCount += value;
                HookHandler.Hookget_PlayingEmissionCount();
            }
            remove => HookHandler._afterget_PlayingEmissionCount -= value;
        }

        public static event Delegates.GetPlayingEmission_NormalArgs GetPlayingEmission
        {
            add
            {
                HookHandler._afterGetPlayingEmission += value;
                HookHandler.HookGetPlayingEmission();
            }
            remove => HookHandler._afterGetPlayingEmission -= value;
        }

        public static event Delegates.PlayEmission_NormalArgs PlayEmission
        {
            add
            {
                HookHandler._afterPlayEmission += value;
                HookHandler.HookPlayEmission();
            }
            remove => HookHandler._afterPlayEmission -= value;
        }

        public static event Delegates.StopAllEmissions_NormalArgs StopAllEmissions
        {
            add
            {
                HookHandler._afterStopAllEmissions += value;
                HookHandler.HookStopAllEmissions();
            }
            remove => HookHandler._afterStopAllEmissions -= value;
        }

        public static event Delegates.StopAllEmissionsWithTag_NormalArgs StopAllEmissionsWithTag
        {
            add
            {
                HookHandler._afterStopAllEmissionsWithTag += value;
                HookHandler.HookStopAllEmissionsWithTag();
            }
            remove => HookHandler._afterStopAllEmissionsWithTag -= value;
        }

        public static event Delegates.Update_NormalArgs Update
        {
            add
            {
                HookHandler._afterUpdate += value;
                HookHandler.HookUpdate();
            }
            remove => HookHandler._afterUpdate -= value;
        }

        public static event Delegates.AdjustForPlatform_NormalArgs AdjustForPlatform
        {
            add
            {
                HookHandler._afterAdjustForPlatform += value;
                HookHandler.HookAdjustForPlatform();
            }
            remove => HookHandler._afterAdjustForPlatform -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event Delegates.get_IsPaused_NormalArgs get_IsPaused
        {
            add => HookEndpointManager.Add<Delegates.get_IsPaused_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_IsPaused"), value);
            remove => HookEndpointManager.Remove<Delegates.get_IsPaused_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_IsPaused"), value);
        }

        public static event Delegates.set_IsPaused_NormalArgs set_IsPaused
        {
            add => HookEndpointManager.Add<Delegates.set_IsPaused_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "set_IsPaused"), value);
            remove => HookEndpointManager.Remove<Delegates.set_IsPaused_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "set_IsPaused"), value);
        }

        public static event Delegates.get_PlayingEmissionCount_NormalArgs get_PlayingEmissionCount
        {
            add => HookEndpointManager.Add<Delegates.get_PlayingEmissionCount_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_PlayingEmissionCount"), value);
            remove => HookEndpointManager.Remove<Delegates.get_PlayingEmissionCount_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(GamepadVibrationMixer), "get_PlayingEmissionCount"), value);
        }

        public static event On.GamepadVibrationMixer.hook_GetPlayingEmission GetPlayingEmission
        {
            add => On.GamepadVibrationMixer.GetPlayingEmission += value;
            remove => On.GamepadVibrationMixer.GetPlayingEmission -= value;
        }

        public static event On.GamepadVibrationMixer.hook_PlayEmission PlayEmission
        {
            add => On.GamepadVibrationMixer.PlayEmission += value;
            remove => On.GamepadVibrationMixer.PlayEmission -= value;
        }

        public static event On.GamepadVibrationMixer.hook_StopAllEmissions StopAllEmissions
        {
            add => On.GamepadVibrationMixer.StopAllEmissions += value;
            remove => On.GamepadVibrationMixer.StopAllEmissions -= value;
        }

        public static event On.GamepadVibrationMixer.hook_StopAllEmissionsWithTag StopAllEmissionsWithTag
        {
            add => On.GamepadVibrationMixer.StopAllEmissionsWithTag += value;
            remove => On.GamepadVibrationMixer.StopAllEmissionsWithTag -= value;
        }

        public static event On.GamepadVibrationMixer.hook_Update Update
        {
            add => On.GamepadVibrationMixer.Update += value;
            remove => On.GamepadVibrationMixer.Update -= value;
        }

        public static event On.GamepadVibrationMixer.hook_AdjustForPlatform AdjustForPlatform
        {
            add => On.GamepadVibrationMixer.AdjustForPlatform += value;
            remove => On.GamepadVibrationMixer.AdjustForPlatform -= value;
        }
    }
}