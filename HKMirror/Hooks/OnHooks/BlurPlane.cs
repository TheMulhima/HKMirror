using MonoMod.RuntimeDetour;
using MonoMod.RuntimeDetour.HookGen;

namespace HKMirror.Hooks.OnHooks;

/// <summary>
///     Contains different types of On Hooks for BlurPlane class.<br />
///     Contains hooks that aren't generated by monomod, and before and after orig hooks for easier hooking.
/// </summary>
public static class OnBlurPlane
{
    internal static class HookHandler
    {
        private static readonly List<string> HookedList = new();

        internal static void Hookget_OriginalMaterial()
        {
            if (!HookedList.Contains("get_OriginalMaterial"))
            {
                HookedList.Add("get_OriginalMaterial");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_OriginalMaterial"),
                    get_OriginalMaterial);
            }
        }

        internal static event Delegates.get_OriginalMaterial_BeforeArgs _beforeget_OriginalMaterial;
        internal static event Delegates.get_OriginalMaterial_NormalArgs _afterget_OriginalMaterial;

        private static Material get_OriginalMaterial(Func<BlurPlane, Material> orig, BlurPlane self)
        {
            Delegates.Params_get_OriginalMaterial @params = new()
            {
                self = self
            };
            _beforeget_OriginalMaterial?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_OriginalMaterial != null) retVal = _afterget_OriginalMaterial.Invoke(@params);
            return retVal;
        }

        internal static void Hookset_OriginalMaterial()
        {
            if (!HookedList.Contains("set_OriginalMaterial"))
            {
                HookedList.Add("set_OriginalMaterial");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "set_OriginalMaterial"),
                    set_OriginalMaterial);
            }
        }

        internal static event Delegates.set_OriginalMaterial_BeforeArgs _beforeset_OriginalMaterial;
        internal static event Delegates.set_OriginalMaterial_NormalArgs _afterset_OriginalMaterial;

        private static void set_OriginalMaterial(Action<BlurPlane, Material> orig, BlurPlane self, Material value)
        {
            Delegates.Params_set_OriginalMaterial @params = new()
            {
                self = self, value = value
            };
            _beforeset_OriginalMaterial?.Invoke(@params);
            self = @params.self;
            value = @params.value;
            orig(self, value);
            if (_afterset_OriginalMaterial != null) _afterset_OriginalMaterial.Invoke(@params);
        }

        internal static void Hookget_BlurPlaneCount()
        {
            if (!HookedList.Contains("get_BlurPlaneCount"))
            {
                HookedList.Add("get_BlurPlaneCount");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_BlurPlaneCount", false),
                    get_BlurPlaneCount);
            }
        }

        internal static event Delegates.get_BlurPlaneCount_BeforeArgs _beforeget_BlurPlaneCount;
        internal static event Delegates.get_BlurPlaneCount_NormalArgs _afterget_BlurPlaneCount;

        private static int get_BlurPlaneCount(Func<int> orig)
        {
            _beforeget_BlurPlaneCount?.Invoke();
            var retVal = orig();
            if (_afterget_BlurPlaneCount != null) retVal = _afterget_BlurPlaneCount.Invoke();
            return retVal;
        }

        internal static void HookGetBlurPlane()
        {
            if (!HookedList.Contains("GetBlurPlane"))
            {
                HookedList.Add("GetBlurPlane");
                On.BlurPlane.GetBlurPlane += GetBlurPlane;
            }
        }

        internal static event Delegates.GetBlurPlane_BeforeArgs _beforeGetBlurPlane;
        internal static event Delegates.GetBlurPlane_NormalArgs _afterGetBlurPlane;

        private static BlurPlane GetBlurPlane(On.BlurPlane.orig_GetBlurPlane orig, int index)
        {
            Delegates.Params_GetBlurPlane @params = new()
            {
                index = index
            };
            _beforeGetBlurPlane?.Invoke(@params);
            index = @params.index;
            var retVal = orig(index);
            if (_afterGetBlurPlane != null) retVal = _afterGetBlurPlane.Invoke(@params);
            return retVal;
        }

        internal static void Hookget_ClosestBlurPlane()
        {
            if (!HookedList.Contains("get_ClosestBlurPlane"))
            {
                HookedList.Add("get_ClosestBlurPlane");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_ClosestBlurPlane", false),
                    get_ClosestBlurPlane);
            }
        }

        internal static event Delegates.get_ClosestBlurPlane_BeforeArgs _beforeget_ClosestBlurPlane;
        internal static event Delegates.get_ClosestBlurPlane_NormalArgs _afterget_ClosestBlurPlane;

        private static BlurPlane get_ClosestBlurPlane(Func<BlurPlane> orig)
        {
            _beforeget_ClosestBlurPlane?.Invoke();
            var retVal = orig();
            if (_afterget_ClosestBlurPlane != null) retVal = _afterget_ClosestBlurPlane.Invoke();
            return retVal;
        }

        internal static void Hookget_PlaneZ()
        {
            if (!HookedList.Contains("get_PlaneZ"))
            {
                HookedList.Add("get_PlaneZ");
                new Hook(ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_PlaneZ"), get_PlaneZ);
            }
        }

        internal static event Delegates.get_PlaneZ_BeforeArgs _beforeget_PlaneZ;
        internal static event Delegates.get_PlaneZ_NormalArgs _afterget_PlaneZ;

        private static float get_PlaneZ(Func<BlurPlane, float> orig, BlurPlane self)
        {
            Delegates.Params_get_PlaneZ @params = new()
            {
                self = self
            };
            _beforeget_PlaneZ?.Invoke(@params);
            self = @params.self;
            var retVal = orig(self);
            if (_afterget_PlaneZ != null) retVal = _afterget_PlaneZ.Invoke(@params);
            return retVal;
        }

        internal static void HookInit()
        {
            if (!HookedList.Contains("Init"))
            {
                HookedList.Add("Init");
                On.BlurPlane.Init += Init;
            }
        }

        internal static event Delegates.Init_BeforeArgs _beforeInit;
        internal static event Delegates.Init_NormalArgs _afterInit;

        private static void Init(On.BlurPlane.orig_Init orig)
        {
            _beforeInit?.Invoke();
            orig();
            if (_afterInit != null) _afterInit.Invoke();
        }

        internal static void HookAwake()
        {
            if (!HookedList.Contains("Awake"))
            {
                HookedList.Add("Awake");
                On.BlurPlane.Awake += Awake;
            }
        }

        internal static event Delegates.Awake_BeforeArgs _beforeAwake;
        internal static event Delegates.Awake_NormalArgs _afterAwake;

        private static void Awake(On.BlurPlane.orig_Awake orig, BlurPlane self)
        {
            Delegates.Params_Awake @params = new()
            {
                self = self
            };
            _beforeAwake?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterAwake != null) _afterAwake.Invoke(@params);
        }

        internal static void HookOnEnable()
        {
            if (!HookedList.Contains("OnEnable"))
            {
                HookedList.Add("OnEnable");
                On.BlurPlane.OnEnable += OnEnable;
            }
        }

        internal static event Delegates.OnEnable_BeforeArgs _beforeOnEnable;
        internal static event Delegates.OnEnable_NormalArgs _afterOnEnable;

        private static void OnEnable(On.BlurPlane.orig_OnEnable orig, BlurPlane self)
        {
            Delegates.Params_OnEnable @params = new()
            {
                self = self
            };
            _beforeOnEnable?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnEnable != null) _afterOnEnable.Invoke(@params);
        }

        internal static void HookOnDisable()
        {
            if (!HookedList.Contains("OnDisable"))
            {
                HookedList.Add("OnDisable");
                On.BlurPlane.OnDisable += OnDisable;
            }
        }

        internal static event Delegates.OnDisable_BeforeArgs _beforeOnDisable;
        internal static event Delegates.OnDisable_NormalArgs _afterOnDisable;

        private static void OnDisable(On.BlurPlane.orig_OnDisable orig, BlurPlane self)
        {
            Delegates.Params_OnDisable @params = new()
            {
                self = self
            };
            _beforeOnDisable?.Invoke(@params);
            self = @params.self;
            orig(self);
            if (_afterOnDisable != null) _afterOnDisable.Invoke(@params);
        }

        internal static void HookSetPlaneVisibility()
        {
            if (!HookedList.Contains("SetPlaneVisibility"))
            {
                HookedList.Add("SetPlaneVisibility");
                On.BlurPlane.SetPlaneVisibility += SetPlaneVisibility;
            }
        }

        internal static event Delegates.SetPlaneVisibility_BeforeArgs _beforeSetPlaneVisibility;
        internal static event Delegates.SetPlaneVisibility_NormalArgs _afterSetPlaneVisibility;

        private static void SetPlaneVisibility(On.BlurPlane.orig_SetPlaneVisibility orig, BlurPlane self,
            bool isVisible)
        {
            Delegates.Params_SetPlaneVisibility @params = new()
            {
                self = self, isVisible = isVisible
            };
            _beforeSetPlaneVisibility?.Invoke(@params);
            self = @params.self;
            isVisible = @params.isVisible;
            orig(self, isVisible);
            if (_afterSetPlaneVisibility != null) _afterSetPlaneVisibility.Invoke(@params);
        }

        internal static void HookSetPlaneMaterial()
        {
            if (!HookedList.Contains("SetPlaneMaterial"))
            {
                HookedList.Add("SetPlaneMaterial");
                On.BlurPlane.SetPlaneMaterial += SetPlaneMaterial;
            }
        }

        internal static event Delegates.SetPlaneMaterial_BeforeArgs _beforeSetPlaneMaterial;
        internal static event Delegates.SetPlaneMaterial_NormalArgs _afterSetPlaneMaterial;

        private static void SetPlaneMaterial(On.BlurPlane.orig_SetPlaneMaterial orig, BlurPlane self, Material material)
        {
            Delegates.Params_SetPlaneMaterial @params = new()
            {
                self = self, material = material
            };
            _beforeSetPlaneMaterial?.Invoke(@params);
            self = @params.self;
            material = @params.material;
            orig(self, material);
            if (_afterSetPlaneMaterial != null) _afterSetPlaneMaterial.Invoke(@params);
        }
    }

    /// <summary>
    ///     Contains necessary information to create Hooks. Does not contain any hooks
    /// </summary>
    public static class Delegates
    {
        public delegate void Awake_BeforeArgs(Params_Awake args);

        public delegate void Awake_NormalArgs(Params_Awake args);

        public delegate void get_BlurPlaneCount_BeforeArgs();

        public delegate int get_BlurPlaneCount_NormalArgs();

        public delegate void get_ClosestBlurPlane_BeforeArgs();

        public delegate BlurPlane get_ClosestBlurPlane_NormalArgs();

        public delegate void get_OriginalMaterial_BeforeArgs(Params_get_OriginalMaterial args);

        public delegate Material get_OriginalMaterial_NormalArgs(Params_get_OriginalMaterial args);

        public delegate void get_PlaneZ_BeforeArgs(Params_get_PlaneZ args);

        public delegate float get_PlaneZ_NormalArgs(Params_get_PlaneZ args);

        public delegate void GetBlurPlane_BeforeArgs(Params_GetBlurPlane args);

        public delegate BlurPlane GetBlurPlane_NormalArgs(Params_GetBlurPlane args);

        public delegate void Init_BeforeArgs();

        public delegate void Init_NormalArgs();

        public delegate void OnDisable_BeforeArgs(Params_OnDisable args);

        public delegate void OnDisable_NormalArgs(Params_OnDisable args);

        public delegate void OnEnable_BeforeArgs(Params_OnEnable args);

        public delegate void OnEnable_NormalArgs(Params_OnEnable args);

        public delegate void set_OriginalMaterial_BeforeArgs(Params_set_OriginalMaterial args);

        public delegate void set_OriginalMaterial_NormalArgs(Params_set_OriginalMaterial args);

        public delegate void SetPlaneMaterial_BeforeArgs(Params_SetPlaneMaterial args);

        public delegate void SetPlaneMaterial_NormalArgs(Params_SetPlaneMaterial args);

        public delegate void SetPlaneVisibility_BeforeArgs(Params_SetPlaneVisibility args);

        public delegate void SetPlaneVisibility_NormalArgs(Params_SetPlaneVisibility args);

        public sealed class Params_get_OriginalMaterial
        {
            public BlurPlane self;
        }

        public sealed class Params_set_OriginalMaterial
        {
            public BlurPlane self;
            public Material value;
        }

        public sealed class Params_GetBlurPlane
        {
            public int index;
        }

        public sealed class Params_get_PlaneZ
        {
            public BlurPlane self;
        }

        public sealed class Params_Awake
        {
            public BlurPlane self;
        }

        public sealed class Params_OnEnable
        {
            public BlurPlane self;
        }

        public sealed class Params_OnDisable
        {
            public BlurPlane self;
        }

        public sealed class Params_SetPlaneVisibility
        {
            public bool isVisible;
            public BlurPlane self;
        }

        public sealed class Params_SetPlaneMaterial
        {
            public Material material;
            public BlurPlane self;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code before orig(self) is called
    /// </summary>
    public static class BeforeOrig
    {
        public static event Delegates.get_OriginalMaterial_BeforeArgs get_OriginalMaterial
        {
            add
            {
                HookHandler._beforeget_OriginalMaterial += value;
                HookHandler.Hookget_OriginalMaterial();
            }
            remove => HookHandler._beforeget_OriginalMaterial -= value;
        }

        public static event Delegates.set_OriginalMaterial_BeforeArgs set_OriginalMaterial
        {
            add
            {
                HookHandler._beforeset_OriginalMaterial += value;
                HookHandler.Hookset_OriginalMaterial();
            }
            remove => HookHandler._beforeset_OriginalMaterial -= value;
        }

        public static event Delegates.get_BlurPlaneCount_BeforeArgs get_BlurPlaneCount
        {
            add
            {
                HookHandler._beforeget_BlurPlaneCount += value;
                HookHandler.Hookget_BlurPlaneCount();
            }
            remove => HookHandler._beforeget_BlurPlaneCount -= value;
        }

        public static event Delegates.GetBlurPlane_BeforeArgs GetBlurPlane
        {
            add
            {
                HookHandler._beforeGetBlurPlane += value;
                HookHandler.HookGetBlurPlane();
            }
            remove => HookHandler._beforeGetBlurPlane -= value;
        }

        public static event Delegates.get_ClosestBlurPlane_BeforeArgs get_ClosestBlurPlane
        {
            add
            {
                HookHandler._beforeget_ClosestBlurPlane += value;
                HookHandler.Hookget_ClosestBlurPlane();
            }
            remove => HookHandler._beforeget_ClosestBlurPlane -= value;
        }

        public static event Delegates.get_PlaneZ_BeforeArgs get_PlaneZ
        {
            add
            {
                HookHandler._beforeget_PlaneZ += value;
                HookHandler.Hookget_PlaneZ();
            }
            remove => HookHandler._beforeget_PlaneZ -= value;
        }

        public static event Delegates.Init_BeforeArgs Init
        {
            add
            {
                HookHandler._beforeInit += value;
                HookHandler.HookInit();
            }
            remove => HookHandler._beforeInit -= value;
        }

        public static event Delegates.Awake_BeforeArgs Awake
        {
            add
            {
                HookHandler._beforeAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._beforeAwake -= value;
        }

        public static event Delegates.OnEnable_BeforeArgs OnEnable
        {
            add
            {
                HookHandler._beforeOnEnable += value;
                HookHandler.HookOnEnable();
            }
            remove => HookHandler._beforeOnEnable -= value;
        }

        public static event Delegates.OnDisable_BeforeArgs OnDisable
        {
            add
            {
                HookHandler._beforeOnDisable += value;
                HookHandler.HookOnDisable();
            }
            remove => HookHandler._beforeOnDisable -= value;
        }

        public static event Delegates.SetPlaneVisibility_BeforeArgs SetPlaneVisibility
        {
            add
            {
                HookHandler._beforeSetPlaneVisibility += value;
                HookHandler.HookSetPlaneVisibility();
            }
            remove => HookHandler._beforeSetPlaneVisibility -= value;
        }

        public static event Delegates.SetPlaneMaterial_BeforeArgs SetPlaneMaterial
        {
            add
            {
                HookHandler._beforeSetPlaneMaterial += value;
                HookHandler.HookSetPlaneMaterial();
            }
            remove => HookHandler._beforeSetPlaneMaterial -= value;
        }
    }

    /// <summary>
    ///     Contains Hooks to that run code after orig(self) is called
    /// </summary>
    public static class AfterOrig
    {
        public static event Delegates.get_OriginalMaterial_NormalArgs get_OriginalMaterial
        {
            add
            {
                HookHandler._afterget_OriginalMaterial += value;
                HookHandler.Hookget_OriginalMaterial();
            }
            remove => HookHandler._afterget_OriginalMaterial -= value;
        }

        public static event Delegates.set_OriginalMaterial_NormalArgs set_OriginalMaterial
        {
            add
            {
                HookHandler._afterset_OriginalMaterial += value;
                HookHandler.Hookset_OriginalMaterial();
            }
            remove => HookHandler._afterset_OriginalMaterial -= value;
        }

        public static event Delegates.get_BlurPlaneCount_NormalArgs get_BlurPlaneCount
        {
            add
            {
                HookHandler._afterget_BlurPlaneCount += value;
                HookHandler.Hookget_BlurPlaneCount();
            }
            remove => HookHandler._afterget_BlurPlaneCount -= value;
        }

        public static event Delegates.GetBlurPlane_NormalArgs GetBlurPlane
        {
            add
            {
                HookHandler._afterGetBlurPlane += value;
                HookHandler.HookGetBlurPlane();
            }
            remove => HookHandler._afterGetBlurPlane -= value;
        }

        public static event Delegates.get_ClosestBlurPlane_NormalArgs get_ClosestBlurPlane
        {
            add
            {
                HookHandler._afterget_ClosestBlurPlane += value;
                HookHandler.Hookget_ClosestBlurPlane();
            }
            remove => HookHandler._afterget_ClosestBlurPlane -= value;
        }

        public static event Delegates.get_PlaneZ_NormalArgs get_PlaneZ
        {
            add
            {
                HookHandler._afterget_PlaneZ += value;
                HookHandler.Hookget_PlaneZ();
            }
            remove => HookHandler._afterget_PlaneZ -= value;
        }

        public static event Delegates.Init_NormalArgs Init
        {
            add
            {
                HookHandler._afterInit += value;
                HookHandler.HookInit();
            }
            remove => HookHandler._afterInit -= value;
        }

        public static event Delegates.Awake_NormalArgs Awake
        {
            add
            {
                HookHandler._afterAwake += value;
                HookHandler.HookAwake();
            }
            remove => HookHandler._afterAwake -= value;
        }

        public static event Delegates.OnEnable_NormalArgs OnEnable
        {
            add
            {
                HookHandler._afterOnEnable += value;
                HookHandler.HookOnEnable();
            }
            remove => HookHandler._afterOnEnable -= value;
        }

        public static event Delegates.OnDisable_NormalArgs OnDisable
        {
            add
            {
                HookHandler._afterOnDisable += value;
                HookHandler.HookOnDisable();
            }
            remove => HookHandler._afterOnDisable -= value;
        }

        public static event Delegates.SetPlaneVisibility_NormalArgs SetPlaneVisibility
        {
            add
            {
                HookHandler._afterSetPlaneVisibility += value;
                HookHandler.HookSetPlaneVisibility();
            }
            remove => HookHandler._afterSetPlaneVisibility -= value;
        }

        public static event Delegates.SetPlaneMaterial_NormalArgs SetPlaneMaterial
        {
            add
            {
                HookHandler._afterSetPlaneMaterial += value;
                HookHandler.HookSetPlaneMaterial();
            }
            remove => HookHandler._afterSetPlaneMaterial -= value;
        }
    }

    /// <summary>
    ///     Contains all On Hooks, even those that aren't in the On namespace such as API generated functions and property
    ///     getters/setters
    /// </summary>
    public static class WithOrig
    {
        public static event Delegates.get_OriginalMaterial_NormalArgs get_OriginalMaterial
        {
            add => HookEndpointManager.Add<Delegates.get_OriginalMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_OriginalMaterial"), value);
            remove => HookEndpointManager.Remove<Delegates.get_OriginalMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_OriginalMaterial"), value);
        }

        public static event Delegates.set_OriginalMaterial_NormalArgs set_OriginalMaterial
        {
            add => HookEndpointManager.Add<Delegates.set_OriginalMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "set_OriginalMaterial"), value);
            remove => HookEndpointManager.Remove<Delegates.set_OriginalMaterial_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "set_OriginalMaterial"), value);
        }

        public static event Delegates.get_BlurPlaneCount_NormalArgs get_BlurPlaneCount
        {
            add => HookEndpointManager.Add<Delegates.get_BlurPlaneCount_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_BlurPlaneCount", false), value);
            remove => HookEndpointManager.Remove<Delegates.get_BlurPlaneCount_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_BlurPlaneCount", false), value);
        }

        public static event On.BlurPlane.hook_GetBlurPlane GetBlurPlane
        {
            add => On.BlurPlane.GetBlurPlane += value;
            remove => On.BlurPlane.GetBlurPlane -= value;
        }

        public static event Delegates.get_ClosestBlurPlane_NormalArgs get_ClosestBlurPlane
        {
            add => HookEndpointManager.Add<Delegates.get_ClosestBlurPlane_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_ClosestBlurPlane", false), value);
            remove => HookEndpointManager.Remove<Delegates.get_ClosestBlurPlane_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_ClosestBlurPlane", false), value);
        }

        public static event Delegates.get_PlaneZ_NormalArgs get_PlaneZ
        {
            add => HookEndpointManager.Add<Delegates.get_PlaneZ_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_PlaneZ"), value);
            remove => HookEndpointManager.Remove<Delegates.get_PlaneZ_NormalArgs>(
                ReflectionHelper.GetMethodInfo(typeof(BlurPlane), "get_PlaneZ"), value);
        }

        public static event On.BlurPlane.hook_Init Init
        {
            add => On.BlurPlane.Init += value;
            remove => On.BlurPlane.Init -= value;
        }

        public static event On.BlurPlane.hook_Awake Awake
        {
            add => On.BlurPlane.Awake += value;
            remove => On.BlurPlane.Awake -= value;
        }

        public static event On.BlurPlane.hook_OnEnable OnEnable
        {
            add => On.BlurPlane.OnEnable += value;
            remove => On.BlurPlane.OnEnable -= value;
        }

        public static event On.BlurPlane.hook_OnDisable OnDisable
        {
            add => On.BlurPlane.OnDisable += value;
            remove => On.BlurPlane.OnDisable -= value;
        }

        public static event On.BlurPlane.hook_SetPlaneVisibility SetPlaneVisibility
        {
            add => On.BlurPlane.SetPlaneVisibility += value;
            remove => On.BlurPlane.SetPlaneVisibility -= value;
        }

        public static event On.BlurPlane.hook_SetPlaneMaterial SetPlaneMaterial
        {
            add => On.BlurPlane.SetPlaneMaterial += value;
            remove => On.BlurPlane.SetPlaneMaterial -= value;
        }
    }
}